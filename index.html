<!doctype html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./deps/web.css">
    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; overflow-x: hidden; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    </style>
    <script>
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('Window Error:', msg, 'at', url, ':', lineNo, ':', columnNo, error);
            return false;
        };
        // Global Polyfills
        var __ANDROID__ = false;
        var __IOS__ = false;
        var global = window.global = window;
        
        // NativeScript tap event bridge
        document.addEventListener('click', (e) => {
            let target = e.target;
            while (target) {
                // Check if element has an ontap handler (Svelte 5 property)
                if (typeof target.ontap === 'function') {
                    target.ontap({ eventName: 'tap', object: target, eventData: e });
                    break;
                }
                target = target.parentNode;
            }
        }, true);

        // Property-to-Attribute sync shim for 'text' and other NS-specific props
        const syncPropToAttr = (el) => {
            if (el._isSynced) return;
            el._isSynced = true;
            
            let textVal = el.text;
            Object.defineProperty(el, 'text', {
                get() { return textVal; },
                set(v) {
                    textVal = v;
                    el.setAttribute('text', v);
                },
                configurable: true
            });
            if (textVal !== undefined) el.setAttribute('text', textVal);
        };

        new MutationObserver((mutations) => {
            mutations.forEach(m => {
                m.addedNodes.forEach(node => {
                    if (node.nodeType === 1) {
                        syncPropToAttr(node);
                        node.querySelectorAll('*').forEach(syncPropToAttr);
                    }
                });
            });
        }).observe(document, { childList: true, subtree: true });
    </script>
    <div id="app-root"></div>
    <script type="module" src="./app/app.ts"></script>
</head>
</html>